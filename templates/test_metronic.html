{% load static %}
<!DOCTYPE html>
<html class="h-full" data-kt-theme="true" data-kt-theme-mode="light" dir="ltr" lang="es">
<head>
    <title>Test Metronic + SACS_BD</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    
    <!-- Favicon -->
    <link rel="shortcut icon" href="{% static 'assets/media/logos/favicon.ico' %}"/>
    
    <!-- Keen Icons (Rutas Corregidas) -->
    <link href="{% static 'assets/vendors/keenicons/styles.bundle.css' %}" rel="stylesheet"/>
    
    <!-- Metronic CSS -->
    <link href="{% static 'assets/css/styles.css' %}" rel="stylesheet"/>
    
    <!-- ApexCharts CSS -->
    <link href="{% static 'assets/vendors/apexcharts/apexcharts.css' %}" rel="stylesheet"/>
    
    <!-- SACS_BD CSS Personalizado -->
    <link href="{% static 'custom/css/sacs-theme.css' %}" rel="stylesheet"/>
    
    <style>
    /* CSS adicional para asegurar que funcione */
    .test-debug {
        border: 2px solid red;
        padding: 10px;
        margin: 10px 0;
    }
    </style>
</head>

<body class="app-default">
    <div class="d-flex flex-column flex-root app-root">
        <div class="container-fluid py-5">
            
            <!-- Header de Prueba -->
            <div class="text-center mb-8">
                <h1 class="display-4 fw-bold text-primary mb-3">SACS_BD + Metronic</h1>
                <p class="fs-4 text-muted">Test de Integración Exitosa 🚀</p>
                <div class="test-debug">
                    <strong>Debug:</strong> 
                    Si ves este borde rojo, CSS está cargando. 
                    Si ves iconos abajo, Keen Icons funciona.
                </div>
            </div>
            
            <!-- Test de Iconos -->
            <div class="text-center mb-6">
                <h3>Test de Iconos Keen:</h3>
                <i class="ki-outline ki-home fs-2x text-primary me-3"></i>
                <i class="ki-outline ki-user fs-2x text-success me-3"></i>
                <i class="ki-outline ki-database fs-2x text-warning me-3"></i>
                <i class="ki-outline ki-notification fs-2x text-danger"></i>
            </div>
            
            <!-- Test de KPI Cards -->
            <div class="row g-6 mb-8">
                <div class="col-lg-3 col-md-6">
                    <div class="sacs-kpi-card sacs-animate-up">
                        <div class="d-flex align-items-center justify-content-between">
                            <div>
                                <div class="sacs-kpi-value">42</div>
                                <div class="sacs-kpi-label">Backups Hoy</div>
                                <div class="sacs-kpi-trend">
                                    <i class="ki-outline ki-arrow-up fs-7"></i>
                                    <span>+12% vs ayer</span>
                                </div>
                            </div>
                            <div class="text-white opacity-75">
                                <i class="ki-outline ki-database fs-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <div class="sacs-kpi-card success sacs-animate-up sacs-delay-100">
                        <div class="d-flex align-items-center justify-content-between">
                            <div>
                                <div class="sacs-kpi-value">8</div>
                                <div class="sacs-kpi-label">Servidores Online</div>
                                <div class="sacs-kpi-trend">
                                    <i class="ki-outline ki-check-circle fs-7"></i>
                                    <span>100% disponibilidad</span>
                                </div>
                            </div>
                            <div class="text-white opacity-75">
                                <i class="ki-outline ki-technology-4 fs-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <div class="sacs-kpi-card warning sacs-animate-up sacs-delay-200">
                        <div class="d-flex align-items-center justify-content-between">
                            <div>
                                <div class="sacs-kpi-value">3</div>
                                <div class="sacs-kpi-label">Alertas Activas</div>
                                <div class="sacs-kpi-trend">
                                    <i class="ki-outline ki-warning fs-7"></i>
                                    <span>Revisar pendientes</span>
                                </div>
                            </div>
                            <div class="text-white opacity-75">
                                <i class="ki-outline ki-notification fs-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <div class="sacs-kpi-card info sacs-animate-up sacs-delay-300">
                        <div class="d-flex align-items-center justify-content-between">
                            <div>
                                <div class="sacs-kpi-value">75%</div>
                                <div class="sacs-kpi-label">Almacenamiento</div>
                                <div class="sacs-kpi-trend">
                                    <i class="ki-outline ki-arrow-up fs-7"></i>
                                    <span>2TB disponible</span>
                                </div>
                            </div>
                            <div class="text-white opacity-75">
                                <i class="ki-outline ki-cd fs-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Test de Componentes -->
            <div class="row g-6">
                <div class="col-xl-8">
                    <div class="sacs-card sacs-animate-up sacs-delay-400">
                        <div class="card-header border-0 pt-5">
                            <h3 class="card-title align-items-start flex-column">
                                <span class="card-label fw-bold fs-3 mb-1">Test de Gráfica</span>
                                <span class="text-muted fw-semibold fs-7">Integración ApexCharts</span>
                            </h3>
                        </div>
                        <div class="card-body">
                            <div id="test_chart" style="height: 300px; border: 1px solid #ddd; border-radius: 8px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-4">
                    <div class="sacs-card sacs-animate-up sacs-delay-500">
                        <div class="card-header border-0 pt-5">
                            <h3 class="card-title">
                                <span class="card-label fw-bold fs-3">Test de Componentes</span>
                            </h3>
                        </div>
                        <div class="card-body">
                            <!-- Test Badges -->
                            <div class="mb-4">
                                <h6>Estados:</h6>
                                <span class="sacs-badge success me-2">Online</span>
                                <span class="sacs-badge danger me-2">Offline</span>
                                <span class="sacs-badge warning">Warning</span>
                            </div>
                            
                            <!-- Test Buttons -->
                            <div class="mb-4">
                                <h6>Botones:</h6>
                                <button class="btn btn-primary btn-sm me-2" onclick="testNotification()">
                                    <i class="ki-outline ki-check fs-7 me-1"></i>
                                    Primario
                                </button>
                                <button class="btn btn-success btn-sm me-2" data-bs-toggle="tooltip" title="Tooltip funcionando">
                                    <i class="ki-outline ki-star fs-7 me-1"></i>
                                    Éxito
                                </button>
                                <button class="btn btn-warning btn-sm" onclick="testConfirm()">
                                    <i class="ki-outline ki-warning fs-7 me-1"></i>
                                    Confirmar
                                </button>
                            </div>
                            
                            <!-- Test Icons -->
                            <div>
                                <h6>Iconos Keen:</h6>
                                <i class="ki-outline ki-home fs-2x text-primary me-3"></i>
                                <i class="ki-outline ki-user fs-2x text-success me-3"></i>
                                <i class="ki-outline ki-setting fs-2x text-warning me-3"></i>
                                <i class="ki-outline ki-notification fs-2x text-danger"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Status Check -->
            <div class="row g-6 mt-6">
                <div class="col-12">
                    <div class="alert alert-success d-flex align-items-center">
                        <i class="ki-outline ki-check-circle fs-2x text-success me-4"></i>
                        <div>
                            <h4 class="alert-heading mb-1">¡Integración Exitosa!</h4>
                            <p class="mb-0">Metronic v9.2.2 se ha integrado correctamente con Django. Los assets, CSS personalizado y JavaScript funcionan perfectamente.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Debug Info -->
            <div class="row g-6 mt-6">
                <div class="col-12">
                    <div class="test-debug">
                        <h5>Debug Info:</h5>
                        <p><strong>CSS Cargado:</strong> <span id="css-status">Verificando...</span></p>
                        <p><strong>ApexCharts:</strong> <span id="apex-status">Verificando...</span></p>
                        <p><strong>SACS JS:</strong> <span id="sacs-status">Verificando...</span></p>
                        <p><strong>Bootstrap:</strong> <span id="bootstrap-status">Verificando...</span></p>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
    
    <!-- Metronic JS Core -->
    <script src="{% static 'assets/js/core.bundle.js' %}"></script>
    
    <!-- Metronic Utilities -->
    <script src="{% static 'assets/vendors/ktui/ktui.min.js' %}"></script>
    
    <!-- ApexCharts -->
    <script src="{% static 'assets/vendors/apexcharts/apexcharts.min.js' %}"></script>
    
    <!-- SACS_BD JS Personalizado -->
    <script src="{% static 'custom/js/sacs-app.js' %}"></script>
    
    <script>
    // Funciones de test
    function testNotification() {
        alert('¡Botón funcionando! 🎉\n\nSi ves este mensaje, JavaScript está cargando correctamente.');
    }
    
    function testConfirm() {
        if (confirm('¿Confirmar esta acción de prueba?')) {
            alert('¡Confirmado! ✅');
        } else {
            alert('Cancelado ❌');
        }
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        console.log('🚀 SACS_BD Test page loaded');
        
        // Debug status checks
        setTimeout(() => {
            // Check CSS
            const testDiv = document.querySelector('.test-debug');
            const cssStatus = window.getComputedStyle(testDiv).border;
            document.getElementById('css-status').textContent = cssStatus.includes('red') ? '✅ Cargado' : '❌ No cargado';
            
            // Check ApexCharts
            document.getElementById('apex-status').textContent = typeof ApexCharts !== 'undefined' ? '✅ Disponible' : '❌ No disponible';
            
            // Check SACS JS
            document.getElementById('sacs-status').textContent = typeof window.SACS !== 'undefined' ? '✅ Cargado' : '❌ No cargado';
            
            // Check Bootstrap
            document.getElementById('bootstrap-status').textContent = typeof bootstrap !== 'undefined' ? '✅ Disponible' : '❌ No disponible';
        }, 1000);
        
        // Test de gráfica con ApexCharts
        if (typeof ApexCharts !== 'undefined') {
            var options = {
                series: [{
                    name: 'Backups Exitosos',
                    data: [30, 40, 35, 50, 49, 60, 70, 91, 125]
                }, {
                    name: 'Backups Fallidos',
                    data: [2, 3, 1, 4, 2, 1, 3, 2, 4]
                }],
                chart: {
                    height: 300,
                    type: 'line',
                    toolbar: {
                        show: false
                    }
                },
                colors: ['#1b84ff', '#f1416c'],
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    curve: 'smooth',
                    width: 3
                },
                xaxis: {
                    categories: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep']
                },
                grid: {
                    borderColor: '#f1f1f1',
                },
                tooltip: {
                    theme: 'light'
                }
            };

            var chart = new ApexCharts(document.querySelector("#test_chart"), options);
            chart.render();
            
            console.log('✅ ApexCharts renderizado correctamente');
        } else {
            console.log('⚠️ ApexCharts no disponible');
            document.getElementById('test_chart').innerHTML = '<div class="text-center text-muted py-5"><h5>ApexCharts no disponible</h5><p>Verifica que se esté cargando: /static/assets/vendors/apexcharts/apexcharts.min.js</p></div>';
        }
        
        // Test final con notificación
        setTimeout(() => {
            if (window.SACS && typeof window.SACS.showNotification === 'function') {
                window.SACS.showNotification('🎉 ¡Integración Metronic + SACS_BD completada!', 'success', 8000);
            }
            console.log('🎉 Test de integración completado');
        }, 2000);
    });
    </script>
</body>
</html>
